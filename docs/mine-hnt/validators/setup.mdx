---
id: validator-run
title: Validators (Testnet)
hide_title: true
sidebar_label: Run a validator
slug: /mine-hnt/validators/validator-run
---

import useBaseUrl from "@docusaurus/useBaseUrl";

# Run a validator

The following options exist to build a Validator node:

* From [docker image](#docker-image)
* From [source](#source)

Regardless of the option, the genesis block needs to be installed:

``` Download command goes here```
```miner genesis load </absolute/path/to/genesis/block>```


## Configure Cloud Platform for Initial Blockhain Sync
If you choose to run your validator in a cloud platform (e.g., Amazon AWS) your CPU usage credits could easily be depleted during the initial sync of the blockchain. To avoid having your instance throttled (e.g., Amazon EC2 instances), check with your cloud platform to see if you can temporarily uncap your instance by setting CPU credit usage to unlimited.

## Port Forwarding

Regardless of using docker or source, before launching a validator node configure the TCP port on your network. Validators communicate to peers over port: 2154/TCP. The networking logic knows how to get around a lack of forwarding, but validators will gain improved performance by forwarding the port.

## <a name="docker-image"></a>From Docker image

See technical requirements [here](/mine-hnt/validators/requirements).

First, update the package manager registry:
```sudo apt-get update```

Then, install Docker:

```sudo apt-get install docker.io```

To avoid needing to use docker with sudo privileges, add your user to the docker group, replacing ```$USER``` with your username:

```sudo usermod -aG docker $USER```

Log in and out of your account to apply these changes. You are now ready to use Docker.

### Run a Docker Container

Note: on amd64 systems AVX support is required. Verify that it exists on your host system:
```
grep avx /proc/cpuinfo
grep avx2 /proc/cpuinfo
```
If nothing is returned from these commands, your host system does not have AVX support and your validator may not be stable.

### Start Container

Before running the container for the first time, it is advisable to pick a "system mount point", i.e., a directory in your host system; some long-term data is stored there. This allows you to easily maintain your validator's blockchain identity (i.e. swarm keys) and blockchain state through image updates.

If you are using a Linux system, you can just create a directory in your user's home directory:
```mkdir ~/miner_data```

If you are using Ubuntu as user ubuntu, this path would now be ```/home/ubuntu/miner_data```. This will be used later.
Now you can try the ```run``` command to start your container for the first time:

```
docker run -d \
--restart always \
--publish 2154:2154/tcp \
--name miner \
--mount type=bind,source=/home/ubuntu/miner_data,target=/var/data \
quay.io/team-helium/miner:miner-xxxNN_YYYY.MM.DD
```

Replace xxxNN with the architecture used, i.e. amd64 or arm64, and with the release date of the image.

The ```-d``` option runs in detached mode, which makes the command return or not; you may want to omit if you have a daemon manager running the docker for you.

The ```--restart always``` option asks Docker to keep the image running, starting the image on boot and restarting the image if it crashes. Depending on how you installed Docker in your system, it'll start on boot. In the AWS AMI above, we use systemd (```systemctl status docker``` to check).

The ```--name miner``` names the container, which makes interacting with the docker easier, but feel free to name the container whatever you want.

The ```--mount``` with the parameters above will mount the container's ```/var/data/``` directory to the systems directory ```/home/ec2-user/miner_data```.

### Interact with the Validator within the Container

You may want to interrogate the Validator or interact with it. Docker's ```exec``` command enables this e.g.:
```docker exec miner miner info height```

In other words, prepend ```docker exec miner``` to any of the commands documented or create an alias such as: ```alias miner="docker exec miner miner"```.
And start the container again as described above, but with the new release tag. 

Thanks to the ```--mount``` option, the blockchain data and the validator keys are preserved through updates.

After setup is complete, check [Monitor a validator section](/mine-hnt/validators/validator-monitor).

## <a name="source"></a>From source

See technical requirements [here](/mine-hnt/validators/requirements).

Software packages:
* miner software
* erlang package (the latest 22 or 23 versions are supported, the 24 release candidate will explicity NOT work)
* libwxgtk package

First, you'll need [git](https://git-scm.com/). If you don't have it installed:

```sudo apt-get install git```

Clone the git repository:
[git clone](https://github.com/helium/miner.git).

### Instructions

```sudo apt-get update -y```

#### Clone validator branch of miner
```git clone -b pevm/validators https://github.com/helium/miner.git```

#### Get Erlang 22.3.1 package
```wget https://packages.erlang-solutions.com/erlang/debian/pool/esl-erlang_22.3.1-1~ubuntu~bionic_amd64.deb```

#### Get libwxgtk package
```wget http://mirrors.kernel.org/ubuntu/pool/universe/w/wxwidgets3.0/libwxgtk3.0-0v5_3.0.4+dfsg-3_amd64.deb```

#### Install dependencies
```sudo apt install -y libdbus-1-dev autoconf automake libtool flex libgmp-dev cmake libsodium-dev libssl-dev bison libsnappy-dev libclang-dev doxygen make cargo```


```
sudo apt install g++ -y
sudo apt install -y libsctp1
sudo apt install -y libncurses5
sudo apt install -y libwxbase3.0-0v5
sudo apt install -y build-essential cmake
sudo apt install -y libdbus-1-dev
sudo apt install -y mosh vim 
sudo apt install -y parallel
```

#### unpackage libwxgtk
```
sudo dpkg -i libwxgtk3.0-0v5_3.0.4+dfsg-3_amd64.deb
sudo apt update -y
```

#### unpack erlang 22.3.1
```sudo dpkg -i esl-erlang_22.3.1-1~ubuntu~bionic_amd64.deb```

#### install erlang 22.3.1
```sudo apt-get install -f```

#### change to miner directory
```cd miner```

#### build miner (validator)
```./rebar3 as validator release```

After setup is complete, check [Monitor a validator section](/mine-hnt/validators/validator-monitor).